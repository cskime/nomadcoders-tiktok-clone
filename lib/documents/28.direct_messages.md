# Direct messages

## Model structure

- `chat_rooms` collection에 chat room document 저장
- `chat_rooms/:room_id` document에 두 참여자의 user id 저장
- `chat_rooms/:room_id/texts` sub collection을 만들어서 chat room에 포함된 message들을 저장
- 전체 구조
  - `chat_rooms/:room_id` : chat room 1개의 정보를 저장하는 document
    - `userA`와 `userB`의 id를 저장
  - `chat_rooms/:room_id/texts/:text_id` : chat room에 저장되는 message 1개의 정보를 저장하는 document
    - `userId`와 `text`를 저장

## Riverpod

- `AsyncNotifierProvider`를 `ref.watch(provider)`로 가져왔을 때, `when`으로 loading, data, error 3개 함수에서 각각 다른 widget을 반환하도록 만들었음
- `when` 대신 `isLoading` 등 특정 상태값만 가져와서 특정 widget의 상태만 갱신시킬 수도 있음
- `watch`를 사용했으므로 `AsyncNotifier`에서 `state` 값이 변경될 때 마다 rebuild 되면서 갱신될 것
